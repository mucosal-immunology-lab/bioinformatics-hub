
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../../NextFlow/dada2_16S/">
      
      
        <link rel="next" href="../../../Utilities/data-best-practices/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Linear modelling with bio_limma - Mucosal Immunology Bioinformatics Hub</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheet/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-7HN0DB92MT"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-7HN0DB92MT",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-7HN0DB92MT",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#linear-modelling-with-bio_limma" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Mucosal Immunology Bioinformatics Hub" class="md-header__button md-logo" aria-label="Mucosal Immunology Bioinformatics Hub" data-md-component="logo">
      
  <img src="../../../assets/mil_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mucosal Immunology Bioinformatics Hub
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Linear modelling with bio_limma
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://mucosal-immunology-lab.github.io/bioinformatics-hub/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Mucosal-Immunology-Lab/bioinformatic-hub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Mucosal Immunology Bioinformatics Hub" class="md-nav__button md-logo" aria-label="Mucosal Immunology Bioinformatics Hub" data-md-component="logo">
      
  <img src="../../../assets/mil_logo.png" alt="logo">

    </a>
    Mucosal Immunology Bioinformatics Hub
  </label>
  
    <div class="md-nav__source">
      <a href="https://mucosal-immunology-lab.github.io/bioinformatics-hub/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Mucosal-Immunology-Lab/bioinformatic-hub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../RNAseq/rnaseq-nfcore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bulk Transcriptomics
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Microbiome
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Microbiome
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    16S rRNA amplicon
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            16S rRNA amplicon
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Microbiome/dada2_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DADA2 pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    LCMS Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            LCMS Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LCMS/lcms-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LCMS/msdial-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Raw Data Processing with MS-DIAL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LCMS/pmp-quality-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Peak Matrix Processing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LCMS/secondary-feature-annotation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Secondary Feature Annotation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../LCMS/manual-peak-curation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Manual Peak Curation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Nextflow Pipelines
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Nextflow Pipelines
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NextFlow/scRNAseq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single-cell RNAseq
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NextFlow/metagenomics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metagenomics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../NextFlow/dada2_16S/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DADA2 16S rRNA
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cross-omic Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Cross-omic Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" checked>
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Differential testing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Differential testing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Linear modelling with bio_limma
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Linear modelling with bio_limma
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview üìñ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputs" class="md-nav__link">
    <span class="md-ellipsis">
      Inputs üî¢
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Function parameters ‚öôÔ∏è
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-output" class="md-nav__link">
    <span class="md-ellipsis">
      Function output üéÅ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example ‚ú®
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example ‚ú®">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microbiome-data-with-custom-model-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Microbiome data with custom model matrix ü¶†
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rights" class="md-nav__link">
    <span class="md-ellipsis">
      Rights
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Handling sequencing data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Handling sequencing data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Utilities/data-best-practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data best practices
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Utilities/convert-raw-novaseq-outputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Converting NovaSeq outputs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Utilities/sra-data-submission/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SRA sequencing data submission
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Monash data storage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Monash data storage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Utilities/market-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Market storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Utilities/vault-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vault storage
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../PublicDatasets/public-datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Public Datasets
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview üìñ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputs" class="md-nav__link">
    <span class="md-ellipsis">
      Inputs üî¢
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Function parameters ‚öôÔ∏è
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-output" class="md-nav__link">
    <span class="md-ellipsis">
      Function output üéÅ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example ‚ú®
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example ‚ú®">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#microbiome-data-with-custom-model-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Microbiome data with custom model matrix ü¶†
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rights" class="md-nav__link">
    <span class="md-ellipsis">
      Rights
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="linear-modelling-with-bio_limma">Linear modelling with <code>bio_limma</code></h1>
<h2 id="overview">Overview üìñ</h2>
<p>Here we discuss the application of a <strong>wrapper function</strong> around the popular <code>limma</code> linear modelling package for differential abundance and expression testing of biological datasets in R.
Our <a href="../../../assets/CrossOmicTools/DifferentialTesting/bio_limma.R"><code>bio_limma()</code></a> function can neatly handle this task and enable rapid exploratory analysis of the effect of various associated sample metadata, including correcting for various potential confounders. 
Please see the <a href="https://bioconductor.org/packages/release/bioc/html/limma.html">limma documentation</a> for further details regarding the main package if you have any particular limma-related queries.</p>
<div class="admonition info">
<p class="admonition-title">Citation</p>
<p>If you use this function and end up publishing something, please consider including a reference to our work! üòéüôè</p>
<p>Macowan, M., Pattaroni, C., Iacono, G., &amp; Marsland, B. (2025). Linear modelling for differential abundance with bio_limma - a wrapper around limma. Zenodo. <a href="https://zenodo.org/records/15726180">https://doi.org/10.5281/zenodo.15726180</a></p>
</div>
<h2 id="inputs">Inputs üî¢</h2>
<p>Currently the function is suited to handle typical R data container formats related to microbiome, LCMS, and RNAseq data.</p>
<table>
<thead>
<tr>
<th>Data format</th>
<th>Usage and notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>phyloseq</code></td>
<td>Classic format for microbiome data, as per our <a href="../../../Microbiome/dada2_pipeline/">DADA2 pipeline guide</a>. The function will use the OTU table and sample data as inputs.</td>
</tr>
<tr>
<td><code>SummarizedExperiment</code></td>
<td>Format used for metabolomic and lipidomic analysis, as per our <a href="../../../LCMS/lcms-analysis/">LCMS data processing guide</a>. The function will use the assay matrix and <code>@metadata$metadata</code> data as inputs.</td>
</tr>
<tr>
<td><code>DGEList</code></td>
<td>Format that we typically use for storing bulk RNAseq datasets, as per our <a href="../../../RNAseq/rnaseq-nfcore/">RNAseq data processing guide</a>. The function will use the assay and metadata as inputs.</td>
</tr>
<tr>
<td><code>EList</code></td>
<td>This is the object type resulting from an original <code>DGEList</code> object that has undergone <code>voom</code> normalisation &ndash; this is typical and means that <code>bio_limma()</code> doesn't then perform <code>voom</code> normalisation if requested. The function will use the <code>E</code> matrix and <code>targets</code> sample data table as inputs.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title"><code>SummarizedExperiment</code> metadata is expected in a certain location</p>
<p>The <code>bio_limma()</code> function expects that the metadata for your <code>SummarizedExperiment</code> can be found in <code>data.frame</code> format at <code>SE_obj@metadata$metadata</code>, which is the case if you have followed our LCMS data processing guide.
However, if you have created your object using a different approach, then it may be stored instead under the <code>colData</code> list element for example.
If this is the case, then simply make a copy and place it in the correct location for use with <code>bio_limma()</code>.</p>
<p>Also, your feature naming column within the <code>elementMetadata</code> is expected to be called <code>shortname</code>. This was a convention on our part when setting up the LCMS processing pipeline. You can either copy your column to a new <code>elementMetadata</code> column called <code>shortname</code>, or pass the row names to the function directly as an argument.</p>
</div>
<h2 id="function-parameters">Function parameters ‚öôÔ∏è</h2>
<p>Because this function progressively evolved over time to handle the various tasks we wanted for our exploratory data analysis, there are a lot of different options you can set. View the pop-down window below for information on what parameters you can set.</p>
<details class="info">
<summary>What parameters and options can I set?</summary>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>input_data</code></td>
<td>An appropriate input data format. A <code>phyloseq</code> object, a <code>SummarizedExperiment</code> object (containing metabolomics/lipidomics data and a feature naming column called <code>shortname</code>), or an RNAseq <code>DGEList</code> of <code>EList</code> object to use for differential abundance testing.</td>
</tr>
<tr>
<td><code>metadata_var</code></td>
<td>OPTIONAL: the name of a <strong>single</strong> column from the <code>sample_data</code> to use for DA testing (e.g. <code>metadata_var = 'group'</code>). <strong>NOT</strong> required if providing a formula &ndash; it will be changed to <code>NULL</code> if you also provide <code>model_formula_as_string</code>. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>metadata_condition</code></td>
<td>OPTIONAL: a conditional statement about a certain metadata value, e.g. keep a certain treatment group only. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>metadata_keep_columns</code></td>
<td>OPTIONAL: this is typically required when you have complex metadata, and also supply your own model matrix and contrasts matrix. Choose columns from your metadata to retain using a character vector with column names. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>model_formula_as_string</code></td>
<td>Just like it sounds &ndash; a string containing the model formula you want to use. Only works with <code>+</code> and not <code>*</code> at this stage. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>model_matrix</code></td>
<td>OPTIONAL: although the function can create its own model matrix for simple testing, this is typically a good option for customising your comparisons. Also requires that provide a contrasts matrix. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>contrast_matrix</code></td>
<td>OPTIONAL: the corresponding contrasts matrix to complement the custom model matrix. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>use_contrast_matrix</code></td>
<td>A boolean selector for whether to use the contrast matrix or a selected coefficient. Best to leave this alone unless you're finding an error &ndash; the function will set this itself. (default: <code>TRUE</code>)</td>
</tr>
<tr>
<td><code>coefficients</code></td>
<td>A selection of coefficients you want to be tested. This will depend on the order of variables in the formula, and you can select as many as you'd like, e.g. <code>coefficients = 2</code> or <code>coefficients = 3:4</code>. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>DGEList_slot</code></td>
<td>Only used for RNAseq analysis when using a <code>DGEList</code> object as your input data. It tells this function which assay slot to use for analysis. Supply a string giving the name of the assay if it is not <code>'counts'</code>. (default: <code>'counts'</code>)</td>
</tr>
<tr>
<td><code>factor_reorder_list</code></td>
<td>OPTIONAL: a named list containing reordered factor values, e.g. <code>list(Group = c('GroupHealthy', 'GroupDisease'))</code>. This is only needed if you don't supply your own contrasts matrix, because then the first factor level will be used as the reference group. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>continuous_modifier_list</code></td>
<td>OPTIONAL: a named list containing functions to alter continuous metadata variables, e.g. <code>list(Age = function(x) x / 365)</code> to change ages in days to ages in years. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>adjust_method</code></td>
<td>OPTIONAL: the method used to correct for multiple comparisons, listed <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/p.adjust">here</a>. (default: <code>'BH'</code>)</td>
</tr>
<tr>
<td><code>rownames</code></td>
<td>OPTIONAL: a custom vector of names to be used if you don't wish the names to be automatically derived from your input data object. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>tax_id_col</code></td>
<td>OPTIONAL: the <code>phyloseq</code> object <code>tax_table</code> column you wish to use for naming. This should match the level being tested (and should also match the deepest taxonomic level in the <code>phyloseq</code> object). If you want to test a higher level, then agglomerate the data using the <code>phyloseq::tax_glom()</code> function. If you do not provide this, then the function will automatically select the deepest level, i.e. the right-most column that isn't entirely composed on <code>NA</code> values. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>override_tax_id_check</code></td>
<td>OPTIONAL: if you have decided to ignore the <code>phyloseq::tax_glom()</code> step, you can technically bypass the requirements for the <code>tax_id_col</code> argument by setting this to <code>TRUE</code>. You should really just go back and agglomerate your dataset though! (default: <code>FALSE</code>)</td>
</tr>
<tr>
<td><code>cores</code></td>
<td>EXPERIMENTAL: I would just avoid this parameter for now - it was part of an experimental edit to allow use of multiple cores for faster generation of figures. If your code is running slowly, it is 100% just because of the individual feature plots step &ndash; setting <code>max_feature_plot_pages</code> to a lower value like <code>5</code> will solve this. You will still get your volcano plots and bar plots in either case. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>adj_pval_threshold</code></td>
<td>The minimum level deemed statistically significant. (default: <code>0.05</code>)</td>
</tr>
<tr>
<td><code>logFC_threshold</code></td>
<td>The minimum logFC threshold deemed significant &ndash; this can vary a lot depending on the scale of your metadata variable. (default: <code>1</code>)</td>
</tr>
<tr>
<td><code>legend_metadata_string</code></td>
<td>OPTIONAL: a custom name for colour or fill options. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>volc_plot_title</code></td>
<td>OPTIONAL: a custom title for the volcano plot (will be reused for the associated bar plots and individual feature plots). (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>volc_plot_subtitle</code></td>
<td>OPTIONAL: a custom subtitle for the volcano plot (will be reused for the associated bar plots and individual feature plots). (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>use_groups_as_subtitle</code></td>
<td>OPTIONAL: if set to <code>TRUE</code>, the function will use the group names (or the contrast matrix comparison names) as the volcano plot subtitle. (default: <code>FALSE</code>)</td>
</tr>
<tr>
<td><code>volc_plot_xlab</code></td>
<td>OPTIONAL: a custom <code>x</code> label for the volcano plot. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>volc_plot_ylab</code></td>
<td>OPTIONAL: a custom <code>y</code> label for the volcano plot. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>remove_low_variance_taxa</code></td>
<td>OPTIONAL: is set to <code>TRUE</code>, the <code>phyloseq</code> OTU table will be checked for feature-wise variance, and all features with zero variance will be removed prior to downstream analysis. You may find <code>limma</code> throws an error if most of the features have no variance, so this step is sometimes required for certain datasets. (default: <code>FALSE</code>)</td>
</tr>
<tr>
<td><code>plot_output_folder</code></td>
<td>OPTIONAL: a path to a folder where you would like output plots to be saved. If left blank, no plots will be saved. It will create a new folder if it does not exist at the final level &ndash; the parent folder must still exist. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>plot_file_prefix</code></td>
<td>OPTIONAL: a string to attach to the start of the individual file names for your plots. This input is only used if the <code>plot_output_folder</code> argument is also provided. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>redo_boxplot_stats</code></td>
<td>OPTIONAL: box plot statistics can be recalculated using <code>stat_compare_means()</code> from the <code>ggpubr</code> package. The default option will only show the <code>limma</code> statistics for the single comparison, so setting this to <code>TRUE</code> can provide more information, particularly if you have more than 2 levels for your categorical variable. (default: <code>FALSE</code>)</td>
</tr>
<tr>
<td><code>max_feature_plot_pages</code></td>
<td>OPTIONAL: if an integer value is given, it will limit the number of feature plots generated &ndash; there will still be 12 plots per page. If you have a large number of significant features, setting this argument to something like 5 will dramatically improve running speed &ndash; this is the primary function bottleneck in terms of processing speed. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>use_voom</code></td>
<td>OPTIONAL: this is used for RNAseq analysis, and will perform <code>voom</code> normalisation prior to running the <code>limma::fitLM()</code> function using the input data nd model matrix. Typically this will have been run prior to differential testing, and your input data will already be of type <code>EList</code>. (default: <code>FALSE</code>)</td>
</tr>
<tr>
<td><code>force_feature_table_variable</code></td>
<td>OPTIONAL: if you provide your own model matrix and contrast matrix, <code>bio_limma</code> will attempt to determine which metadata column is being referenced when it tries to generate the feature plots. It does so using the <code>stringdist</code> pacakge, and does a pretty good job. However, if it is getting it wrong (especially if you have decided to make a nice contrast name that isn't close to the metadata column name), you can set this argument to the correct variable to ensure you get the plots you want. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>feature_plot_dot_colours</code></td>
<td>OPTIONAL: you can colour the dots in your feature plots using a <strong>categorical</strong> variable identified by providing a string with the name of a metadata column. Keep in mind this column should be complete to avoid potential errors (i.e. no <code>NA</code> values). (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>feature_plot_beeswarm_cex</code></td>
<td>OPTIONAL: use this value to determine the horizontal spread of the dots. See <a href="https://www.rdocumentation.org/packages/ggbeeswarm/versions/0.7.2"><code>ggbeeswarm</code></a> documentation for more details. (default: <code>NULL</code>)</td>
</tr>
<tr>
<td><code>theme_pubr</code></td>
<td>OPTIONAL: set this to <code>TRUE</code> to get cleaner, prettier plots using the <code>ggpubr</code> <code>theme_pubr</code> theme. (default: <code>FALSE</code>)</td>
</tr>
</tbody>
</table>
</details>
<h2 id="function-output">Function output üéÅ</h2>
<p>The function will return a list with different outputs from the analysis.</p>
<table>
<thead>
<tr>
<th>List element</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>input_data</code></td>
<td>The original counts table used to run the analysis.</td>
</tr>
<tr>
<td><code>input_metadata</code></td>
<td>A <code>data.frame</code> with the original metadata you provided.</td>
</tr>
<tr>
<td><code>test_variables</code></td>
<td>A <code>data.frame</code> with the subset of metadata variables used for the analysis.</td>
</tr>
<tr>
<td><code>model_matrix</code></td>
<td>The model matrix generated (or provided) to the function.</td>
</tr>
<tr>
<td><code>contrast_matrix</code> OR <code>coefficients</code></td>
<td>Either the contrast matrix used, or the coefficients selected, depending on the analysis you chose to run.</td>
</tr>
<tr>
<td><code>limma_significant</code></td>
<td>A list of <code>data.frames</code> containing the significant differentially abundant features determined by the <code>limma()</code> function, with the adjusted p-value and logFC threshold selected, for each comparison/coefficient.</td>
</tr>
<tr>
<td><code>limma_all</code></td>
<td>A list of <code>data.frames</code> containing the significance levels and logFC of all features, regardless of their significance, for each comparison/coefficient.</td>
</tr>
<tr>
<td><code>volcano_plots</code></td>
<td>Volcano plots for each of the comparisons/coefficients selected.</td>
</tr>
<tr>
<td><code>bar_plots</code></td>
<td>Bar plots combining significant features for each of the comparisons/coefficients selected. The x-axis shows the logFC values calculated by <code>limma</code>, with features names on the y-axis, ordered by the effect magnitude.</td>
</tr>
<tr>
<td><code>feature_plots</code></td>
<td>Individual box or scatter plots for each feature, for each of the comparisons/coefficients selected.</td>
</tr>
<tr>
<td><code>venn_diagram</code></td>
<td>An empty shell that originally contained the Venn diagram that showed up when running the function... This needs to be updated by using another Venn diagram function &ndash; hopefully to come in the future!</td>
</tr>
</tbody>
</table>
<details class="info">
<summary>Which plot files are saved to disk?</summary>
<p>If a plot output folder path is provided, for each comparison/coefficient you have selected, three output <code>.pdf</code> files will be generated (provided there is at least 1 significant feature). All will have the calculated prefix: <code>{plot_file_prefix}_{test_variable + group}_</code>.</p>
<table>
<thead>
<tr>
<th>File name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>volcplot.pdf</code></td>
<td>A volcano plot showing all features, with significant features labelled. Decreased and increased features are shown in blue and red respectively.</td>
</tr>
<tr>
<td><code>barplot.pdf</code></td>
<td>A bar plot showing significant features, with the logFC on the x-axis and the feature name on the y-axis. The y-axis is ordered by logFC magnitude, with negative at the bottom and positive at the top. Negative logFC features are coloured blue, while positive ones are coloured red. The top features of each direction are selected for plotting, and the plot will resize if there are fewer values than this.</td>
</tr>
<tr>
<td><code>featureplots.pdf</code></td>
<td>Individual box or scatter plots for each feature. These plots are arranged with 12 features to a page (3 columns and 4 rows). Multiple pages will be combined into a single output <code>.pdf</code> files if there are more than 12 significant features.</td>
</tr>
</tbody>
</table>
</details>
<h2 id="example">Example ‚ú®</h2>
<h3 id="microbiome-data-with-custom-model-matrix">Microbiome data with custom model matrix ü¶†</h3>
<p>In this example, we want to find out the effect on the microbiome of two treatment options vs. sham treatment.
We decide to test for the effects of each compared to sham, and then compared the two treatment groups combined compared to sham.</p>
<div class="language-r highlight"><span class="filename">Example of running bio_limma with custom comparisons</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Load required packages</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">pkgs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;BiocGenerics&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;base&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ggtree&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ggplot2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;IRanges&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Matrix&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;S4Vectors&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;biomformat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;plotly&#39;</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">          </span><span class="s">&#39;dplyr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;rstatix&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ggpubr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;stats&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;phyloseq&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;SummarizedExperiment&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ggpmisc&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ggrepel&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ggsci&#39;</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">          </span><span class="s">&#39;grDevices&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;here&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;limma&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;stringr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;stringdist&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ggbeeswarm&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;doParallel&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;openxlsx&#39;</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">pkg</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">pkgs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="nf">suppressPackageStartupMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">pkg</span><span class="p">,</span><span class="w"> </span><span class="n">character.only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">}</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1"># Load phyloseq data</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">bact_data_logCSS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">readRDS</span><span class="p">(</span><span class="nf">here</span><span class="p">(</span><span class="s">&#39;output&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;01_Preprocessing&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;bact_data_logCSS.rds&#39;</span><span class="p">))</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c1"># Prepare the model matrix using the &quot;Treatment&quot; metadata column</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">model_matrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">model.matrix</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Treatment</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">bact_data_logCSS</span><span class="o">@</span><span class="n">sam_data</span><span class="p">))</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="c1"># Prepare the corresponding contrasts matrix</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">contrast_matrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">makeContrasts</span><span class="p">(</span><span class="s">&#39;DrugA_vs_Sham&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TreatmentDrugA</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">TreatmentSham</span><span class="p">,</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">                                 </span><span class="s">&#39;DrugB_vs_Sham&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TreatmentDrugB</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">TreatmentSham</span><span class="p">,</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">                                 </span><span class="s">&#39;EitherDrug_vs_Sham&#39;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">TreatmentDrugA</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">TreatmentDrugB</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">TreatmentSham</span><span class="p">,</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">                                 </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(</span><span class="n">model_matrix</span><span class="p">))</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="c1"># Run bio_limma</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">res</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">bio_limma</span><span class="p">(</span><span class="n">input_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bact_data_logCSS</span><span class="p">,</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">                 </span><span class="n">model_matrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">model_matrix</span><span class="p">,</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">                 </span><span class="n">contrast_matrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contrast_matrix</span><span class="p">,</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="w">                 </span><span class="n">metadata_keep_columns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;Group&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;SubjectID&#39;</span><span class="p">),</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">                 </span><span class="n">logFC_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="w">                 </span><span class="n">adjust_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;BH&#39;</span><span class="p">,</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="w">                 </span><span class="n">adj_pval_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span><span class="p">,</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="w">                 </span><span class="n">redo_boxplot_stats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="w">                 </span><span class="n">force_feature_table_variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Treatment&#39;</span><span class="p">,</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="w">                 </span><span class="n">max_feature_plot_pages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="w">                 </span><span class="n">plot_output_folder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">here</span><span class="p">(</span><span class="s">&#39;figures&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LimmaDA&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ASV&#39;</span><span class="p">),</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="w">                 </span><span class="n">plot_file_prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;BH&#39;</span><span class="p">,</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="w">                 </span><span class="n">theme_pubr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="c1"># Save results to disk</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="nf">saveRDS</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="nf">here</span><span class="p">(</span><span class="s">&#39;figures&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LimmaDA&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ASV&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;limma_res.rds&#39;</span><span class="p">))</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="c1"># Write results tables to an Excel workbook</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="n">limma_sig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">foreach</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">res</span><span class="o">$</span><span class="n">limma_significant</span><span class="p">))</span><span class="w"> </span><span class="o">%do%</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="n">res</span><span class="o">$</span><span class="n">limma_significant</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">rownames_to_column</span><span class="p">(</span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;feature&#39;</span><span class="p">))</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="p">};</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">limma_sig</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">res</span><span class="o">$</span><span class="n">limma_significant</span><span class="p">)</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="nf">write.xlsx</span><span class="p">(</span><span class="n">limma_sig</span><span class="p">,</span><span class="w"> </span><span class="nf">here</span><span class="p">(</span><span class="s">&#39;figures&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LimmaDA&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;ASV&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;limma_DA_significant.xlsx&#39;</span><span class="p">))</span>
</span></code></pre></div>
<h2 id="rights">Rights</h2>
<ul>
<li>Copyright ¬©Ô∏è 2024 Mucosal Immunology Lab, Monash University, Melbourne, Australia.</li>
<li>Licence: This software is provided under the MIT license.</li>
<li>Authors: M. Macowan</li>
</ul>
<div class="admonition info">
<ul>
<li><strong>limma</strong>: Ritchie ME, Phipson B, Wu D, Hu Y, Law CW, Shi W, Smyth GK (2015). "limma powers differential expression analyses for RNA-sequencing and microarray studies." Nucleic Acids Research, 43(7), e47. doi:10.1093/nar/gkv007.</li>
<li><strong>ggplot2</strong>: Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org.</li>
<li><strong>ggpubr</strong>: Kassambara A (2023). ggpubr: 'ggplot2' Based Publication Ready Plots. R package version 0.6.0, https://rpkgs.datanovia.com/ggpubr/.</li>
<li><strong>ggrepel</strong>: Slowikowski K (2024). ggrepel: Automatically Position Non-Overlapping Text Labels with 'ggplot2'. https://ggrepel.slowkow.com/, https://github.com/slowkow/ggrepel.</li>
<li><strong>ggtree</strong>: Yu, G., Smith, D.K., Zhu, H., Guan, Y. and Lam, T.T.-Y. (2017), ggtree: an r package for visualization and annotation of phylogenetic trees with their covariates and other associated data. Methods Ecol Evol, 8: 28-36. https://doi.org/10.1111/2041-210X.12628</li>
<li><strong>biomformat</strong>: McMurdie PJ, Paulson JN (2025). biomformat: An interface package for the BIOM file format. doi:10.18129/B9.bioc.biomformat, R package version 1.36.0, https://bioconductor.org/packages/biomformat.</li>
<li><strong>tidyverse</strong>: Wickham H, Averick M, Bryan J, Chang W, McGowan LD, Fran√ßois R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, M√ºller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). ‚ÄúWelcome to the tidyverse.‚Äù Journal of Open Source Software, 4(43), 1686. doi:10.21105/joss.01686.</li>
<li><strong>phyloseq</strong>: McMurdie and Holmes (2013) phyloseq: An R Package for Reproducible Interactive Analysis and Graphics of Microbiome Census Data. PLoS ONE. 8(4):e61217</li>
<li><strong>SummarizedExperiment</strong>: Morgan M, Obenchain V, Hester J, Pag√®s H (2025). SummarizedExperiment: A container (S4 class) for matrix-like assays. doi:10.18129/B9.bioc.SummarizedExperiment, R package version 1.38.1, https://bioconductor.org/packages/SummarizedExperiment.</li>
<li><strong>edgeR</strong>: Chen Y, Chen L, Lun ATL, Baldoni P, Smyth GK (2025). ‚ÄúedgeR v4: powerful differential analysis of sequencing data with expanded functionality and improved support for small counts and larger datasets.‚Äù Nucleic Acids Research, 53(2), gkaf018. doi:10.1093/nar/gkaf018.</li>
<li><strong>here</strong>: M√ºller K (2025). here: A Simpler Way to Find Your Files. R package version 1.0.1, https://here.r-lib.org/.</li>
<li><strong>stringr</strong>: Wickham H (2023). stringr: Simple, Consistent Wrappers for Common String Operations. R package version 1.5.1, https://github.com/tidyverse/stringr, https://stringr.tidyverse.org.</li>
<li><strong>stringdist</strong>: van der Loo M (2014). ‚ÄúThe stringdist package for approximate string matching.‚Äù The R Journal, 6, 111-122. https://CRAN.R-project.org/package=stringdist.</li>
<li><strong>ggbeeswarm</strong>: Clarke, E., Sherrill-Mix, S., &amp; Dawson, C. (2023). ggbeeswarm: Categorical Scatter (Violin Point) Plots. R package version 0.7.2. CRAN.</li>
<li><strong>doParallel</strong>: Corporation M, Weston S (2022). doParallel: Foreach Parallel Adaptor for the 'parallel' Package. R package version 1.0.17. https://CRAN.R-project.org/package=doParallel</li>
</ul>
</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>